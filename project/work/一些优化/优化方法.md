

1. **绘制调用批处理**：通过减少绘制调用次数来优化 CPU 性能。可以将多个物体使用相同的材质并在一起，以减少渲染命令的数量。
    
2. **纹理图集**：将多个纹理合并到一个大的纹理图中，以减少材质切换和抽样操作，从而提高性能。
    
3. **光照贴图**：使用光照贴图（Lightmapping）来预计算静态物体的光照，避免每帧计算光照，可以显著提高性能。
    
4. **细节层次（LOD）**：为物体设置不同级别的细节，根据物体与摄像机的距离来动态改变细节层次，减少渲染的三角形数量。
    
5. **遮挡剔除**：使用遮挡剔除技术来避免渲染被其他物体遮挡的部分，减少不必要的渲染工作。
    
6. **物理优化**：优化物理模拟，例如降低模拟频率、使用非分配物理 API、减少刚体（Rigidbody）和碰撞器（Collider）的数量。
    
7. **动画优化**：避免使用复杂的动画，如缩放动画，使用 Animator 的层级和状态机优化来减少计算量。
    
8. **资源管理**：合理管理资源的导入和使用，例如使用 Addressable 系统来动态加载和卸载资源，减少初始下载大小和内存使用。
    
9. **着色器优化**：编写高效的着色器代码，避免使用复杂的数学运算，使用合适的数据类型和精度，减少 GPU 计算负担。
    
10. **UI 优化**：优化 UI 元素，例如使用 Canvas 组件的 `GraphicRaycaster` 来优化 UI 渲染，隐藏不可见的 UI 元素来减少每帧的更新。
    
11. **代码优化**：使用非分配的物理查询 API，避免在紧循环中使用 `UnityEngine.Object` 子类的 Null 比较，使用 `ColorUtility` 来优化颜色处理。
    
12. **使用 Profiler**：使用 Unity Profiler 工具来识别性能瓶颈，根据分析结果进行针对性优化。
    
13. **动态分辨率**：对于性能受限的设备，可以使用动态分辨率技术来降低 GPU 的渲染负担。
    
14. **OnDemandRendering API**：对于不需要每帧都渲染的场景，如菜单或暂停屏幕，可以使用 OnDemandRendering API 来降低渲染频率，从而节省资源。


## 1. OnDemandRendering


Unity 的 `OnDemandRendering` API 是一个用于控制和查询应用程序渲染速度的工具，它可以独立于其他子系统（如物理、输入或动画）来调整渲染速度   。这个 API 特别适用于移动端开发，因为它可以在不渲染每一帧的情况下，让其他系统（如物理计算和输入处理）继续以正常速度运行，从而降低功耗和发热量，延长电池续航时间  。

以下是 `OnDemandRendering` API 的一些关键特性和使用方法：

1. **effectiveRenderFrameRate**：这是一个静态属性，返回当前估计的渲染率，以每秒帧数（FPS）表示，并四舍五入到最接近的整数  。

2. **renderFrameInterval**：这个静态属性用于获取或设置当前的帧率间隔。通过设置这个值，你可以控制渲染的频率。例如，将其设置为5，意味着Unity将每隔5帧渲染一次，从而将渲染帧率降低到原来的1/5。要恢复到 `Application.targetFrameRate` 或 `QualitySettings.vSyncCount` 设置的值，可以将此属性设置为0或1  。

3. **willCurrentFrameRender**：这是一个静态属性，如果当前帧将要被渲染，则返回 `true`；如果没有，则返回 `false`。这可以用于在代码中做出是否渲染当前帧的决策  。

使用 `OnDemandRendering` 的场景包括但不限于：
- **菜单和暂停屏幕**：这些通常是静态场景，不需要高帧率渲染 。
- **回合制游戏**：在玩家思考或等待对手时，可以降低帧率以减少不必要的功耗 。
- **内容大部分时间是静态的应用**：例如汽车UI，不需要频繁渲染 。

此外，需要注意的是，使用 `OnDemandRendering` 时，如果设置了不兼容的帧率，应用程序将以尽可能快的速度进行渲染 。在 Android 上使用时，如果还使用 OpenGL ES，`Optimized Frame Pacing` 在帧率为 20、30 或 60 帧/秒时效果最好 。对于 Vulkan，没有这么严格的限制，可以使用更多的有效帧率 。

总的来说，`OnDemandRendering` API 提供了一种灵活的方式来管理Unity应用程序的渲染性能，特别适用于需要优化功耗和热量输出的移动平台  。
